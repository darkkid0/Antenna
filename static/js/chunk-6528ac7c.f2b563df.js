(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6528ac7c"],{"399b":function(e,t,r){"use strict";r("b9c4")},4505:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"platform"},[r("div",{staticClass:"div_card"},[r("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,hideRequiredMark:!0}},[r("div",{staticClass:"title clearfix"},[r("div",{staticClass:"left"},[e._v("平台设置")])]),r("div",{staticClass:"content"},[r("a-form-model-item",{attrs:{label:"开放注册"}},[r("a-switch",{on:{click:function(t){return e.openBtn(t,"OPEN_REGISTER")}},model:{value:e.form.OPEN_REGISTER,callback:function(t){e.$set(e.form,"OPEN_REGISTER",t)},expression:"form.OPEN_REGISTER"}})],1),r("a-form-model-item",{attrs:{label:"仅允许邀请注册"}},[r("a-switch",{on:{click:function(t){return e.openBtn(t,"INVITE_TO_REGISTER")}},model:{value:e.form.INVITE_TO_REGISTER,callback:function(t){e.$set(e.form,"INVITE_TO_REGISTER",t)},expression:"form.INVITE_TO_REGISTER"}})],1),r("a-form-model-item",{ref:"PLATFORM_DOMAIN",attrs:{label:"平台域名",prop:"PLATFORM_DOMAIN"}},[r("a-input",{attrs:{"addon-before":"http://",placeholder:"请输入"},model:{value:e.form.PLATFORM_DOMAIN,callback:function(t){e.$set(e.form,"PLATFORM_DOMAIN",t)},expression:"form.PLATFORM_DOMAIN"}})],1),r("a-form-model-item",{attrs:{label:"开启邮件通知"}},[r("a-switch",{on:{click:function(t){return e.openBtn(t,"OPEN_EMAIL")}},model:{value:e.form.OPEN_EMAIL,callback:function(t){e.$set(e.form,"OPEN_EMAIL",t)},expression:"form.OPEN_EMAIL"}})],1),r("a-form-model-item",{ref:"EMAIL_HOST",attrs:{label:"SMTP服务器",prop:"EMAIL_HOST"}},[r("a-input",{attrs:{placeholder:"必填,仅支持smtp协议,如：smtp.xxx.com"},on:{blur:function(){e.$refs.EMAIL_HOST.onFieldBlur()}},model:{value:e.form.EMAIL_HOST,callback:function(t){e.$set(e.form,"EMAIL_HOST",t)},expression:"form.EMAIL_HOST"}})],1),r("a-form-model-item",{ref:"EMAIL_PORT",attrs:{label:"端口",prop:"EMAIL_PORT"}},[r("a-input",{attrs:{placeholder:"必填,如：334"},on:{blur:function(){e.$refs.EMAIL_PORT.onFieldBlur()}},model:{value:e.form.EMAIL_PORT,callback:function(t){e.$set(e.form,"EMAIL_PORT",t)},expression:"form.EMAIL_PORT"}})],1),r("a-form-model-item",{ref:"EMAIL_HOST_USER",attrs:{label:"账号",prop:"EMAIL_HOST_USER"}},[r("a-input",{attrs:{placeholder:"必填,如：text@xxx.com"},on:{blur:function(){e.$refs.EMAIL_HOST_USER.onFieldBlur()}},model:{value:e.form.EMAIL_HOST_USER,callback:function(t){e.$set(e.form,"EMAIL_HOST_USER",t)},expression:"form.EMAIL_HOST_USER"}})],1),r("a-form-model-item",{ref:"EMAIL_HOST_PASSWORD",attrs:{label:"密码/授权码",prop:"EMAIL_HOST_PASSWORD","wrapper-col":{span:14}}},[r("a-row",[r("a-col",{attrs:{span:17}},[r("a-input",{attrs:{placeholder:"必填,如：text@xxx.com"},on:{blur:function(){e.$refs.EMAIL_HOST_PASSWORD.onFieldBlur()}},model:{value:e.form.EMAIL_HOST_PASSWORD,callback:function(t){e.$set(e.form,"EMAIL_HOST_PASSWORD",t)},expression:"form.EMAIL_HOST_PASSWORD"}})],1),r("a-col",{staticClass:"wb-m-l-5",attrs:{span:2}},[r("a-tooltip",[r("template",{slot:"title"},[e._v("发送测试邮件")]),r("a-button",{attrs:{loading:e.sendMailLoaging,icon:"mail"},on:{click:e.getSendMail}})],2)],1)],1)],1),r("a-form-model-item",{staticClass:"wb-m-t-20",attrs:{"wrapper-col":{offset:4}}},[r("a-button",{attrs:{type:"primary",loading:e.renewLoading},on:{click:function(t){return e.onSubmit("ruleForm")}}},[e._v("保存")]),r("a-button",{staticClass:"wb-m-l-5",on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)])],1),r("div",{staticClass:"div_card"},[r("a-form-model",{ref:"ruleForm1",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,hideRequiredMark:!0}},[r("div",{staticClass:"title clearfix"},[r("div",{staticClass:"left"},[e._v("协议设置")])]),r("div",{staticClass:"content"},[r("a-form-model-item",{ref:"DNS_DOMAIN",attrs:{label:"DNS记录域名",prop:"DNS_DOMAIN"}},[r("a-input",{attrs:{placeholder:"必填,仅支持smtp协议,如：smtp.xxx.com"},model:{value:e.form.DNS_DOMAIN,callback:function(t){e.$set(e.form,"DNS_DOMAIN",t)},expression:"form.DNS_DOMAIN"}})],1),r("a-form-model-item",{ref:"SERVER_IP",attrs:{label:"解析IP",prop:"SERVER_IP"}},[r("a-input",{attrs:{placeholder:"必填,如0.0.0.0"},model:{value:e.form.SERVER_IP,callback:function(t){e.$set(e.form,"SERVER_IP",t)},expression:"form.SERVER_IP"}})],1),r("a-form-model-item",{ref:"NS1_DOMAIN",attrs:{label:"NS1域名",prop:"NS1_DOMAIN"}},[r("a-input",{attrs:{placeholder:"必填,仅支持smtp协议,如：smtp.xxx.com"},model:{value:e.form.NS1_DOMAIN,callback:function(t){e.$set(e.form,"NS1_DOMAIN",t)},expression:"form.NS1_DOMAIN"}})],1),r("a-form-model-item",{ref:"NS2_DOMAIN",attrs:{label:"NS2域名",prop:"NS2_DOMAIN"}},[r("a-input",{attrs:{placeholder:"必填,如：334"},model:{value:e.form.NS2_DOMAIN,callback:function(t){e.$set(e.form,"NS2_DOMAIN",t)},expression:"form.NS2_DOMAIN"}})],1),r("a-form-model-item",{ref:"JNDI_PORT",attrs:{label:"JNDI监听端口",prop:"JNDI_PORT"}},[r("a-input",{attrs:{placeholder:"必填,如：text@xxx.com"},model:{value:e.form.JNDI_PORT,callback:function(t){e.$set(e.form,"JNDI_PORT",t)},expression:"form.JNDI_PORT"}})],1),r("a-form-model-item",{staticClass:"wb-m-t-20",attrs:{"wrapper-col":{span:4,offset:4}}},[r("a-button",{attrs:{type:"primary",loading:e.protocalUpdateLoafing},on:{click:function(t){return e.onSubmit("ruleForm1")}}},[e._v(" 保存 ")]),r("a-button",{staticClass:"wb-m-l-5",on:{click:function(t){return e.resetForm("ruleForm1")}}},[e._v("重置")])],1)],1)])],1)])},o=[],s=r("0995"),l={data(){return{labelCol:{span:4},wrapperCol:{span:10},wrapperCol1:{span:20},form:{OPEN_REGISTER:"",name:"",INVITE_TO_REGISTER:"",PLATFORM_DOMAIN:"",OPEN_EMAIL:"",EMAIL_HOST:"",EMAIL_HOST_USER:"",EMAIL_PORT:"",EMAIL_HOST_PASSWORD:"",DNS_DOMAIN:"",SERVER_IP:"",NS1_DOMAIN:"",NS2_DOMAIN:"8080",JNDI_PORT:""},formSpare:{},rules:{PLATFORM_DOMAIN:[{required:!0,message:"域名必填",trigger:"blur"},{pattern:new RegExp("^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$"),message:"仅支持域名格式",trigger:"blur"}],EMAIL_HOST:[{validator:this.validatePass,trigger:"blur"},{pattern:new RegExp("^[^一-鿿]+$"),message:"不支持中文",trigger:"blur"}],EMAIL_PORT:[{validator:this.validatePass,trigger:"blur"},{pattern:new RegExp("^[0-9]+$"),message:"只支持数字",trigger:"blur"}],EMAIL_HOST_USER:[{validator:this.validatePass,trigger:"blur"}],EMAIL_HOST_PASSWORD:[{validator:this.validatePass,trigger:"blur"}],DNS_DOMAIN:[{required:!0,message:"不可为空",trigger:"blur"}],SERVER_IP:[{required:!0,message:"不可为空",trigger:"blur"}],NS1_DOMAIN:[{required:!0,message:"不可为空",trigger:"blur"}],NS2_DOMAIN:[{required:!0,message:"不可为空",trigger:"blur"}],JNDI_PORT:[{required:!0,message:"不可为空",trigger:"blur"},{pattern:new RegExp("^[0-9]+$"),message:"只支持数字",trigger:"blur"}]},renewLoading:!1,protocalUpdateLoafing:!1,sendMailLoaging:!1,form2:{},num:1}},created(){this.initData()},mounted(){},methods:{initData(){s["a"].getConfigsManage({page_size:20}).then(e=>{1===e.code&&(this.form=e.data,this.formSpare=Object.assign({},e.data))})},onSubmit(e){this.$refs[e].validate(t=>{t&&("ruleForm"===e?(this.renewLoading=!0,s["a"].getConfigsRenew(this.form).then(e=>{this.renewLoading=!1,1===e.code?(this.form=e.data,this.formSpare=Object.assign({},e.data),s["a"].platform_restart(),this.$message.success("操作成功")):this.$message.error(e.message)})):(this.protocalUpdateLoafing=!0,s["a"].getConfigsProtocalUpdate(this.form).then(e=>{this.protocalUpdateLoafing=!1,1===e.code?(this.form=e.data,this.formSpare=Object.assign({},e.data),s["a"].platform_restart(),this.$message.success("操作成功")):this.$message.error(e.message),console.log("更新协议配置的返回",e)})))})},getSendMail(){this.sendMailLoaging=!0;let e={EMAIL_HOST:this.form.EMAIL_HOST,EMAIL_PORT:this.form.EMAIL_PORT,EMAIL_HOST_USER:this.form.EMAIL_HOST_USER,EMAIL_HOST_PASSWORD:this.form.EMAIL_HOST_PASSWORD};s["a"].getSendMail(e).then(e=>{this.sendMailLoaging=!1,1===e.code?this.$message.success("操作成功"):this.$message.error(e.message)},e=>{this.sendMailLoaging=!1})},openBtn(e,t){let r=this,a=e?"是否打开":"是否关闭";this.$confirm({title:"提示",content:a,onOk(){},onCancel(){r.form[t]=!e}})},validatePass(e,t,r){this.form.OPEN_EMAIL&&(t||r("不可为空")),r()},resetForm(e){this.$refs[e].resetFields(),this.form=Object.assign({},this.formSpare)}}},i=l,n=(r("399b"),r("2877")),m=Object(n["a"])(i,a,o,!1,null,"331006fe",null);t["default"]=m.exports},b9c4:function(e,t,r){}}]);